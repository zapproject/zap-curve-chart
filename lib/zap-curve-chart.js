!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("bignumber.js"),require("chart.js")):"function"==typeof define&&define.amd?define("ZapCurveChart",["bignumber.js","chart.js"],e):"object"==typeof exports?exports.ZapCurveChart=e(require("bignumber.js"),require("chart.js")):t.ZapCurveChart=e(t.BigNumber,t.Chart)}(window,function(t,e){return function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/",i(i.s=8)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1);e.Curve=class{constructor(t=[]){this.max=0,this.values=t,this.checkValidity()}checkValidity(){for(var t=1,e=0;e<this.values.length;){var i=this.values[e];if(i<=0)throw"Invalid curve length";var s=e+i+1;if(s>=this.values.length)throw"Piece is out of bounds";var n=this.values[s];if(n<=t)throw"Piece domains are overlapping";t=n,e+=i+2}this.max=t}getPrice(t){if(t<=0||t>this.max)throw"Invalid curve supply position";if(!this.values)throw"Curve is not initialized";for(var e=0;e<this.values.length;){var i=this.values[e];if(!(t>this.values[e+i+1])){for(var s=0,n=0;n<i;n++)s+=this.values[e+n+1]*Math.pow(t,n);return s}e+=i+2}return-1}getZapRequired(t,e){for(var i=0,s=t;s<t+e;s++)i+=this.getPrice(s);return i}convertToBNArrays(){return this.values.map(t=>new s.BigNumber(t))}valuesToString(){return this.values.map(t=>""+t)}}},function(e,i){e.exports=t},function(t,i){t.exports=e},function(t,e,i){"use strict";function s(t,e){return Math.round((t+e)/2)}Object.defineProperty(e,"__esModule",{value:!0}),e.reduce=function(t,e){var i=[];if(t<=e){for(var n=1;n<=t;n++)i.push(n);return i}var r=t/(e-2);i.push(1),i.push(s(1,r)),n=r;for(var o=t-r;n<o;)i.push(s(n,n+=r));return i.push(s(t-r,t)),i.push(t),i},e.average=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i(2),n=i(0),r=i(3),o=function(){function t(t,e,i,s){void 0===e&&(e={height:150,width:300}),void 0===i&&(i={}),void 0===s&&(s={}),this.ctxOptions={shadowColor:"#07c",shadowBlur:10,shadowRadius:10,shadowOffsetX:0,shadowOffsetY:0},this.lineOptions={fill:!0,fillOpacity:1,pointStyle:"circle",borderColor:"rgba(0,120,254,0.75)",backgroundColor:"rgba(0,120,254,0.5)",lineTension:.1,borderWidth:2,pointBackgroundColor:"rgba(0,120,254,1)",pointBorderColor:"rgba(0,120,254,1)",pointRadius:0,currentPointRadius:5,pointBorderWidth:0,currentPointBorderWidth:3,currentPointBackgroundColor:void 0,currentPointBorderColor:void 0},this.chart=null,this.chartDatasets=[],this.chartLabels=[],this.canvas=null,this.maxDots=e.maxDots||300,this.canvas=document.createElement("canvas"),e.hasOwnProperty("height")&&(this.canvas.style.height=e.height+"px"),e.hasOwnProperty("width")&&(this.canvas.style.width=e.width+"px"),this.ctxOptions=Object.assign(this.ctxOptions,s),this.lineOptions=Object.assign(this.lineOptions,i),t.appendChild(this.canvas)}return t.prototype.destroy=function(){this.chart&&this.chart.destroy()},t.prototype.getDataset=function(t){var e=new n.Curve(t);return r.reduce(e.max,this.maxDots).map(function(t){return{x:t,y:e.getPrice(t)/1e18}})},t.prototype.draw=function(t,e){var i=this;void 0===t&&(t=[]),void 0===e&&(e=0);var s=this.getDataset(t);this.chartLabels=s.map(function(t){return t.x});var n={pointRadius:[],pointBorderWidth:[]};s.forEach(function(t,r){var o=!!s[r-1]&&s[r-1].x<e&&t.x>=e;n.pointRadius.push(o?i.lineOptions.currentPointRadius:i.lineOptions.pointRadius),n.pointBorderWidth.push(o?i.lineOptions.currentPointBorderWidth:i.lineOptions.pointBorderWidth)}),this.chartDatasets=[{label:"",data:s.map(function(t){return t.y}),fill:this.lineOptions.fill,fillOpacity:this.lineOptions.fillOpacity,pointBackgroundColor:this.lineOptions.pointBackgroundColor,pointBorderColor:this.lineOptions.pointBorderColor,pointStyle:this.lineOptions.pointStyle,borderColor:this.lineOptions.borderColor,backgroundColor:this.lineOptions.backgroundColor,lineTension:this.lineOptions.lineTension,pointRadius:n.pointRadius,pointBorderWidth:n.pointBorderWidth,borderWidth:this.lineOptions.borderWidth}],this.chart||this.renderChart(),this.updateChart()},t.prototype.initContext=function(){var t=this.ctxOptions,e=s.controllers.line.prototype.initialize;return s.controllers.line.prototype.initialize=function(){e.apply(this,arguments);var i=this.chart.chart.ctx,s=i.stroke;i.stroke=function(){i.save(),i.shadowColor=t.shadowColor,i.shadowBlur=t.shadowBlur,i.shadowRadius=t.shadowRadius,i.shadowOffsetX=t.shadowOffsetX,i.shadowOffsetY=t.shadowOffsetY,s.apply(this,arguments),i.restore()}},function(){s.controllers.line.prototype.initialize=e}},t.prototype.renderChart=function(){this.chart&&this.chart.destroy(),this.chart=new s(this.canvas.getContext("2d"),{type:"line",options:{elements:{line:{tension:0}},animation:{duration:0},layout:{padding:{top:7,bottom:0,left:-10}},responsive:!1,maintainAspectRatio:!1,tooltips:{enabled:!0,intersect:!1,mode:"index"},legend:{display:!1},scales:{xAxes:[{ticks:{display:!1,minRotation:0,padding:5},gridLines:{drawBorder:!1,zeroLineWidth:0,display:!1,drawTicks:!1},scaleLabel:{display:!1,labelString:"Dot number"}}],yAxes:[{ticks:{display:!1,beginAtZero:!0},gridLines:{drawBorder:!1,zeroLineWidth:0,display:!1,drawTicks:!0},scaleLabel:{display:!1,labelString:"Dot price"}}]}},data:{datasets:[],labels:[]}})},t.prototype.updateChart=function(){if(this.chart){this.chart.data.datasets=this.chartDatasets,this.chart.data.labels=this.chartLabels;var t=2*Math.max.apply(null,this.chartDatasets[0].data);this.chart.options.scales.yAxes[0].ticks.max=t;var e=Math.min.apply(null,this.chartLabels);this.chart.options.scales.xAxes[0].ticks.min=e;var i=this.initContext();this.chart.update(),i()}},t}();e.CurveLineChart=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i(2),n=i(0);i(6);var r=function(){function t(t,e){void 0===e&&(e={height:150,width:150}),this.chart=null,this.chartDatasets=[],this.chartLabels=[],this.makeHTML(t,e)}return t.prototype.destroy=function(){this.chart&&this.chart.destroy()},t.prototype.makeHTML=function(t,e){this.canvas=document.createElement("canvas"),e.hasOwnProperty("height")&&(this.canvas.style.height=e.height+"px"),e.hasOwnProperty("width")&&(this.canvas.style.width=e.width+"px"),this.issuedDotsContainer=document.createElement("div"),this.issuedDotsContainer.classList.add("curve-doughnut-chart__issued-dots-container"),this.issuedDotsContainer.setAttribute("title","Issued dots"),this.userDotsContainer=document.createElement("div"),this.userDotsContainer.classList.add("curve-doughnut-chart__user-dots-container"),this.userDotsContainer.setAttribute("title","User's dot balance"),this.dotPriceContainer=document.createElement("div"),this.dotPriceContainer.classList.add("curve-doughnut-chart__dot-price-container"),this.dotPriceContainer.setAttribute("title","Current price of dot"),this.chartContainer=document.createElement("div"),this.chartContainer.classList.add("curve-doughnut-chart"),this.chartContainer.appendChild(this.userDotsContainer),this.chartContainer.appendChild(this.canvas),this.chartContainer.appendChild(this.issuedDotsContainer),this.chartContainer.appendChild(this.dotPriceContainer),t.appendChild(this.chartContainer)},t.prototype.draw=function(t,e,i){void 0===e&&(e=0);var s=new n.Curve(t),r=s.max,o=s.getPrice(e+1);this.dotPriceContainer.textContent=o.toString(),this.userDotsContainer.textContent=i.toString(),this.issuedDotsContainer.textContent=e.toString(),this.chartLabels=["Issued dots","Available dots"],this.chartDatasets=[{backgroundColor:["rgba(0,120,254,0.5)","#e5e5e5"],data:[e,r-e]}],this.chart||this.renderChart(),this.updateChart()},t.prototype.updateChart=function(){this.chart&&(this.chart.data.datasets=this.chartDatasets,this.chart.data.labels=this.chartLabels,this.chart.update())},t.prototype.renderChart=function(){this.chart&&this.chart.destroy(),this.chart=new s(this.canvas.getContext("2d"),{type:"doughnut",options:{animation:{duration:0},layout:{padding:{top:7,bottom:0,left:-10}},responsive:!1,maintainAspectRatio:!1,tooltips:{enabled:!0,intersect:!1,mode:"index"},legend:{display:!1}},data:{datasets:[],labels:[]}})},t}();e.CurveDoughnutChart=r},function(t,e,i){},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i(0),n=i(3),r=function(){function t(t,e,i,s){void 0===e&&(e={}),void 0===i&&(i={}),void 0===s&&(s={}),this.container=t,this.coef=1,this.textColor="#fff",this.textBackground="rgba(0, 0, 0, .7)",this.lineOptions={fill:!0,borderWidth:2,borderColor:"rgba(0,120,254,0.75)",backgroundColor:"rgba(0,120,254,0.5)",pointRadius:7,pointBackgroundColor:"rgba(0,120,254,1)"},this.ctxOptions={shadowBlur:3,shadowRadius:3,shadowOffsetX:0,shadowOffsetY:0},this.options={height:150,width:300,maxDots:300},this.black=!1,this.onMouseMove=this.onMouseMove.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.lineOptions=Object.assign(this.lineOptions,i),this.options=Object.assign(this.options,e),this.ctxOptions=Object.assign(this.ctxOptions,s),this.coef=1;var n=this.options,r=n.height,o=n.width;this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttributeNS(null,"viewBox","-10 -"+(r/2-10)+" "+o+" "+r),this.svg.setAttribute("width",o.toString()),this.svg.setAttribute("height",r.toString());var a=document.createElementNS("http://www.w3.org/2000/svg","defs"),h=Math.random()+"shadow";if(this.ctxOptions.shadowRadius){var l=this.getFilter(h);a.append(l)}this.svg.append(a),this.polyline=document.createElementNS("http://www.w3.org/2000/svg","polyline"),this.polyline.setAttributeNS(null,"stroke",this.lineOptions.borderColor),this.polyline.setAttributeNS(null,"fill","none"),this.polyline.setAttributeNS(null,"stroke-width",this.lineOptions.borderWidth.toString()),this.ctxOptions.shadowRadius&&this.polyline.setAttributeNS(null,"filter","url(#"+h+")"),this.fill=document.createElementNS("http://www.w3.org/2000/svg","polyline"),this.fill.setAttributeNS(null,"stroke","none"),this.fill.setAttributeNS(null,"fill",this.lineOptions.backgroundColor),this.fill.setAttributeNS(null,"stroke-width",this.lineOptions.borderWidth.toString()),this.gCircle=document.createElementNS("http://www.w3.org/2000/svg","g"),this.circle=document.createElementNS("http://www.w3.org/2000/svg","circle"),this.circle.setAttributeNS(null,"r",this.lineOptions.pointRadius.toString()),this.circle.setAttributeNS(null,"fill",this.lineOptions.pointBackgroundColor),this.ctxOptions.shadowRadius&&this.circle.setAttributeNS(null,"filter","url(#"+h+")"),this.gCircle.appendChild(this.circle),this.gText=document.createElementNS("http://www.w3.org/2000/svg","g"),this.gText.setAttributeNS(null,"font-size","12"),this.gText.setAttributeNS(null,"font-family","sans-serif"),this.gText.setAttributeNS(null,"stroke","none"),this.gText.setAttributeNS(null,"text-anchor","start"),this.gText.setAttributeNS(null,"fill",this.textColor),this.textM=document.createElementNS("http://www.w3.org/2000/svg","text"),this.textMDots=document.createElementNS("http://www.w3.org/2000/svg","tspan"),this.textMDots.setAttributeNS(null,"dy","1em"),this.textMPrice=document.createElementNS("http://www.w3.org/2000/svg","tspan"),this.textMPrice.setAttributeNS(null,"dy","1em"),this.textM.appendChild(this.textMDots),this.textM.appendChild(this.textMPrice),this.textM.style.visibility="hidden",this.infoText=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.infoText.setAttributeNS(null,"ry","5"),this.infoText.setAttributeNS(null,"rx","5"),this.infoText.setAttributeNS(null,"fill",this.textBackground),this.gText.appendChild(this.textM),this.svg.appendChild(this.fill),this.svg.appendChild(this.polyline),this.svg.appendChild(this.gCircle),this.svg.appendChild(this.infoText),this.svg.appendChild(this.gText),this.container.appendChild(this.svg),this.svg.addEventListener("mousemove",this.onMouseMove),this.svg.addEventListener("mouseout",this.onMouseOut)}return t.prototype.draw=function(t,e){var i=this.getDataset(t,e);this.polyline.setAttributeNS(null,"points",i.polyline),this.fill.setAttributeNS(null,"points",i.fill),this.circle.setAttributeNS(null,"cx",i.currentPos.x>3?i.currentPos.x:3),this.circle.setAttributeNS(null,"cy",i.currentPos.y),this.coef=i.curve.max/this.polyline.getBoundingClientRect().width,this.curve=i.curve},t.prototype.destroy=function(){this.svg.removeEventListener("mousemove",this.onMouseMove),this.svg.removeEventListener("mouseout",this.onMouseOut),this.container.removeChild(this.svg)},t.prototype.onMouseMove=function(t){if(this.curve){this.textM.style.visibility="visible",this.infoText.style.visibility="visible";var e=this.polyline.getBoundingClientRect(),i=t.clientX-e.left>e.width/2?t.clientX-e.left-120:t.clientX-e.left+15,s=t.clientY-e.top>e.height/2?t.clientY-e.top-35:t.clientY-e.top+15,n=Math.round((t.clientX-this.polyline.getBoundingClientRect().left)*this.coef),r=n?this.curve.getPrice(n):0;(r>=1e7&&r<=1e15&&t.clientX-e.left>e.width/2||n>=1e7&&n<=1e15&&t.clientX-e.left>e.width/2)&&(i-=35);var o="";r>1e10&&(r/=1e18,o="e-18"),this.textM.setAttributeNS(null,"x",i.toString()),this.textM.setAttributeNS(null,"y",s.toString()),this.textMDots.setAttributeNS(null,"x",i.toString()),this.textMPrice.setAttributeNS(null,"x",i.toString()),this.textMDots.textContent="Dot: "+n,this.textMPrice.textContent="Price: "+r+o;var a=this.textM.getBoundingClientRect();this.infoText.setAttributeNS(null,"x",(i-5).toString()),this.infoText.setAttributeNS(null,"y",(s-5).toString()),this.infoText.setAttributeNS(null,"width",(a.width+10).toString()),this.infoText.setAttributeNS(null,"height",(a.height+10).toString())}},t.prototype.onMouseOut=function(){this.infoText.style.visibility="hidden",this.textM.style.visibility="hidden"},t.prototype.getFilter=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","filter");e.setAttributeNS(null,"x","-40%"),e.setAttributeNS(null,"y","-40%"),e.setAttributeNS(null,"width","200%"),e.setAttributeNS(null,"height","200%"),e.setAttributeNS(null,"id",t),e.setAttributeNS(null,"filterUnits","userSpaceOnUse");var i=document.createElementNS("http://www.w3.org/2000/svg","feOffset");i.setAttributeNS(null,"result","offOut"),i.setAttributeNS(null,"in",this.black?"SourceAlpha":"SourceGraphic"),i.setAttributeNS(null,"dx",this.ctxOptions.shadowOffsetX.toString()),i.setAttributeNS(null,"dy",this.ctxOptions.shadowOffsetY.toString());var s=document.createElementNS("http://www.w3.org/2000/svg","feGaussianBlur");s.setAttributeNS(null,"result","blurOut"),s.setAttributeNS(null,"in","offOut"),s.setAttributeNS(null,"stdDeviation",this.ctxOptions.shadowRadius.toString());var n=document.createElementNS("http://www.w3.org/2000/svg","feBlend");return n.setAttributeNS(null,"in","SourceGraphic"),n.setAttributeNS(null,"in2","blurOut"),n.setAttributeNS(null,"mode","normal"),e.appendChild(i),e.appendChild(s),e.appendChild(n),e},t.prototype.getDataset=function(t,e){void 0===e&&(e=0);var i=this.options.height/2,r=new s.Curve(t),o=n.reduce(r.max,this.options.maxDots),a=0,h=0;o.forEach(function(t,i,s){e&&!h&&t>=e&&(h=t);var n=r.getPrice(t);n>a&&(a=n)});var l=a/i,u=this.options.maxDots/r.max,d={x:h*u,y:i-(h?r.getPrice(h)/l:0)},c=["0,"+a/l],p=["0,"+a/l];return o.forEach(function(t){c.push(t*u+","+(i-r.getPrice(t)/l)),p.push(t*u+","+(i-r.getPrice(t)/l))}),p.push(this.options.maxDots+","+a/l),{polyline:c.join(" "),fill:p.join(" "),currentPos:d,maxY:a,maxX:r.max,dotsIssued:e,curve:r}},t}();e.CurveSvgLineChart=r},function(t,e,i){t.exports=i(9)},function(t,e,i){"use strict";function s(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),s(i(4)),s(i(5)),s(i(7))}])});